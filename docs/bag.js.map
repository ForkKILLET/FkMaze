{
  "version": 3,
  "sources": ["../../../../nodejs/fkutil/beta/extend.js", "../src/maze.js", "../src/bag.js"],
  "sourcesContent": ["export default {\n\tMath: () => Object.assign(Math, {\n\t\tparseFraction: (i, d) => {\n\t\t\tlet p = + d, q2, q5\n\t\t\tq2 = q5 = d.length\n\t\t\tfor (; ! (p % 2); p /= 2) q2 --\n\t\t\tfor (; ! (p % 5); p /= 5) q5 --\n\t\t\tconst q = 2 ** q2 * 5 ** q5\n\t\t\tif (i[0] === \"-\") p = - p\n\t\t\tp += i * q\n\t\t\treturn [ p, q ]\n\t\t},\n\t\tsimplifyFraction: (p, q) => {\n\t\t\tconst g = Math.gcd(p, q)\n\t\t\treturn [ p / g, q / g ]\n\t\t},\n\t\tgcd: (x, y) => y ? Math.gcd(y, x % y) : x,\n\t\tlcm: (x, y, g) => x * y / (g ?? Math.gcd(x, y))\n\t}),\n\n\tString: () => Object.assign(String.prototype, {\n\t\tsplit2(s) {\n\t\t\tconst i = this.indexOf(s)\n\t\t\treturn i < 0 ? [ this ] : [ this.slice(0, i), this.slice(i + s.length) ]\n\t\t}\n\t}),\n\n\tArray: () => Object.assign(Array.prototype, {\n\t\trepeat(n) {\n\t\t\tlet ret = []\n\t\t\twhile (n --) ret = ret.concat(this)\n\t\t\treturn ret\n\t\t},\n\t\trandomEntry() {\n\t\t\tconst i = ~~ (Math.random() * 1e6) % this.length\n\t\t\treturn [ i, this[i] ]\n\t\t}\n\t})\n}\n", "import extend from \"fkutil-beta/extend.js\"\n\nextend.Array()\n\nexport default class Maze {\n\tstatic WALL = 0\n\tstatic BARRIER = 1\n\tstatic PATH = 2\n\n\tstatic print_chars = \"#X \"\n\tstatic draw_colors = [ \"black\", \"blue\", \"transparent\" ]\n\n\tstatic dx = [ [ 0, -1 ], [ 0, 1 ] ]\n\tstatic dy = [ [ -1, 0 ], [ 1, 0 ] ]\n\tstatic dxy = [ ...Maze.dx, ...Maze.dy ]\n\n\tconstructor(r_max, c_max) {\n\t\tthis.r_max = r_max\n\t\tthis.c_max = c_max\n\t\tthis.map = Array(r_max + 2).fill().map((_, r) => Array(c_max + 2).fill().map((_, c) => ({\n\t\t\ttype: c === 0 || r === 0 || c === c_max + 1 || r === r_max + 1 ? Maze.WALL : r % 2 + c % 2, r, c\n\t\t})))\n\t}\n\n\tneighbor(r, c, dir = \"xy\") {\n\t\treturn Maze[`d${dir}`].map(([ dr, dc ]) => [ r + dr, c + dc ]).filter(([ r, c ]) =>\n\t\t\tr >= 1 && r <= this.r_max && c >= 1 && c <= this.c_max\n\t\t).map(([ r, c ]) => this.map[r][c])\n\t}\n\n\tcells() {\n\t\treturn this.map.flat()\n\t}\n\t[Symbol.iterator]() {\n\t\treturn this.cells().values()\n\t}\n\n\tasync randomize(r_in, c_in, { show_progress, fps } = {}) {\n\t\tconst Bs_marked = []\n\t\tconst visit = ({ r, c }) => {\n\t\t\tthis.map[r][c].visited = true\n\t\t\tthis.neighbor(r, c).filter(({ type }) => type === Maze.BARRIER).forEach(cell => {\n\t\t\t\tcell.sides = this.neighbor(cell.r, cell.c, cell.r % 2 ? \"x\" : \"y\")\n\t\t\t\tcell.visited = true\n\t\t\t\tBs_marked.push(cell)\n\t\t\t})\n\t\t}\n\t\tvisit({ r: r_in, c: c_in })\n\t\twhile (Bs_marked.length) {\n\t\t\tif (show_progress) {\n\t\t\t\tshow_progress(this)\n\t\t\t\tawait new Promise(res => setTimeout(res, 1000 / fps))\n\t\t\t}\n\t\t\tconst [ i, B_random ] = Bs_marked.randomEntry()\n\t\t\tconst P_unvisited = B_random.sides.find(({ visited }) => ! visited)\n\t\t\tif (P_unvisited) {\n\t\t\t\tB_random.type = Maze.PATH\n\t\t\t\tvisit(P_unvisited)\n\t\t\t}\n\t\t\telse B_random.visited = false\n\t\t\tBs_marked.splice(i, 1)\n\t\t}\n\t\tfor (const cell of this) {\n\t\t\tif (cell.type === Maze.BARRIER) cell.type = Maze.WALL\n\t\t\tdelete cell.visited\n\t\t}\n\t}\n\n\tdraw({ canvas, zoom }) {\n\t\tcanvas.width = (this.c_max + 2) * zoom\n\t\tcanvas.height = (this.r_max + 2) * zoom\n\t\tconst ctx = canvas.getContext(\"2d\")\n\t\tfor (const { r, c, type, visited } of this) {\n\t\t\tctx.fillStyle = Maze.draw_colors[type]\n\t\t\tctx.fillRect(r * zoom, c * zoom, zoom, zoom)\n\t\t\tif (visited) {\n\t\t\t\tctx.fillStyle = \"red\"\n\t\t\t\tctx.fillRect((r + .25) * zoom, (c + .25) * zoom, .5 * zoom, .5 * zoom)\n\t\t\t}\n\t\t}\n\t}\n}\n", "import Maze from \"./maze.js\"\n\nenv.exports = async () => {\n\tconst { term, chalk } = env\n\tconst maze = new Maze(25, 25)\n\tconst print = () => {\n\t\tterm.clear()\n\t\tterm.write(maze.map.map(col => col.map(({ type, visited }) => {\n\t\t\tlet ch = Maze.print_chars[type].repeat(2)\n\t\t\tif (visited) ch = chalk.bgRed(ch)\n\t\t\treturn ch\n\t\t}).join(\"\")).join(\"\\r\\n\"))\n\t}\n\tawait maze.randomize(1, 1, { show_progress: draw, fps: 40 })\n\tprint()\n}\n"],
  "mappings": "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",
  "names": []
}
